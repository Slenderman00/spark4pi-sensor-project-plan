% !TeX root = Report.tex
\documentclass[12pt]{article}

% Package imports (organized and deduplicated)
\usepackage{biblatex}
\usepackage{changepage}
\usepackage{color}
\usepackage{enumitem}
\usepackage{float}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{sectsty}
\usepackage{xcolor}
\usepackage[breaklinks=true]{hyperref}
\usepackage{xurl}
\usepackage{tikz}
\usepackage{lipsum}
\usetikzlibrary{shapes.geometric,positioning,fit,backgrounds}
\usepackage{./timing-diagrams}
\usetikzlibrary{calc}
\setcounter{biburlnumpenalty}{100}
\setcounter{biburlucpenalty}{100}
\setcounter{biburllcpenalty}{100}

% \usepackage{background}
% \backgroundsetup{
%   position=current page.north west,
%   angle=0,
%   nodeanchor=north west,
%   vshift=-1cm,
%   hshift=1cm,
%   color=red,
%   opacity=1,
%   scale=1,
%   contents={Preprint}
% }

\definecolor{darkblue}{RGB}{0, 0, 102} 
\hypersetup{
    colorlinks=true,
    pdfborder={0 0 0},
    linkbordercolor=white,
    urlcolor=darkblue,
    linkcolor=darkblue,
    citecolor=darkblue,
    filecolor=darkblue
}

% Make bibliography ragged right instead of justified
\AtBeginDocument{
  \renewcommand{\bibsetup}{\raggedright}
}
% Document configuration
\restylefloat{table}
\graphicspath{{./images/}}
\addbibresource{Library.bib}
\subsectionfont{\fontsize{12}{14}\selectfont}

% Author information
\author{
    Joar Heimonen\\
    \texttt{contact@joar.me}
}

% Title configuration
\title{
    \textbf{Spark4pi-sensors}\\[0.5em]
    \large Project Plan
}
\date{\today}

\newcommand{\license}{
    \vspace{1em}
    \noindent\small{Â© 2024 Joar Heimonen\\
    This work is licensed under a \href{https://creativecommons.org/licenses/by-sa/4.0/}{Creative Commons Attribution-Sharealike 4.0 International License}.}
    \vspace{1em}
}

\begin{document}
\maketitle

\begin{abstract}
    \noindent Spark4pi-sensors is a hardware platform for I2C sensors. It is designed to be scalable utilizing the NETCONF protocol and YANG data models for configuration.
    The platform is designed to be rack mounted taking up one unit in a 19-inch rack. The platform can be powered by one of two methods, a 10-60V power line or through an
    ethernet4pi-zero PoE hat. The platform uses an ICE40 FPGA to establish six different I2C buses, each dedicated to an interface. This makes the platform both performant and easy to integrate.
    The FPGA communicates with a Raspberry Pi Zero which runs the NETCONF server.

\end{abstract}

\pagebreak

\tableofcontents

\pagebreak


\section{Introduction}
When designing a sensor platform, universality is of the highest importance. This document will describe the preliminary design of Spark4pi-sensors and the development plan.
Spark4pi-sensors is a hardware platform for I2C sensors.
The sensor platform is designed to be rack mounted taking up one unit in a 19" rack. This platform is powered by a 10-60V power supply or trough PoE using the ethernet4pi-zero PoE hat.
The platform will be controlled and configured through a NETCONF/YANG interface, this will allow it to scale easily making the sensor network size agnostic.
The platform will be built around an ICE40 FPGA and a Raspberry Pi Zero. All logic will be powered by a 3.3V power line regulated from the main 5V power line.
Spark4pi-sensors is designed with Sensirion sensors in mind, but there is no technical reason why other sensors can't be used.


\section{Technical background}
\subsection{Power Over Ethernet (PoE)}
Power over Ethernet (PoE) is a technology that allows network cables to carry electrical power. 
There are two standards for PoE, IEEE 802.3af and IEEE 802.3at \cite{IEEEStandardsAssociation}. The ethernet4pi-zero PoE hat uses IEEE 802.3af which 
is the older standard and allows for a maximum power draw of 15.4w.

\subsection{Raspberry Pi Zero}
The Raspberry Pi Zero is a single board computer developed by the Raspberry Pi Foundation \cite{foundationTeachLearnMake2025}. 
The Raspberry Pi Zero is the smallest and cheapest Raspberry Pi.

\subsection{Ethernet4pi-zero PoE}
The ethernet4pi-zero PoE is a PoE network shield in the late stages of development.
The shield is designed to be used with the Raspberry Pi Zero and the Raspberry Pi Zero W.
Ethernet4pi-zero PoE is built around a Lightside-Instruments powermod-tps54260 which delivers a maximum of five volts at three amps.
This is equal to a maximum power draw of 15 watts which is the maximum power draw of the IEEE 802.3af standard.

\subsection{Powermod-tps54260}
The powermod-tps54260 is a DC to DC voltage regulator that can deliver a maximum of five volts at three amps.
It works with an input voltage between 10 and 60 volts. The powermod-tps54260 is designed to be modular and
can be placed on any project that requires a stable five-volt power supply. It is based on the Texas Instruments TPS54260 \cite{TPS54260DataSheet}.


\subsection{RJ45}
An RJ45 connector is a type of connector commonly used on Ethernet cables.

\subsection{Sensirion RJ45 sensor interface}
Sensirion uses the RJ45 connector to implement their proprietary sensor interface.
This interface is designed to be used with their reference sensor implementations. Through 
an adapter called the SEK-SensorBridge \cite{agSEKSensorBridgeConnectingBridgeTwo}.

\subsection{YANG}
YANG is a data modeling language, similar to XML. It is used to model and configure the state of network controlled devices \cite{bjorklundYANG11Data2016}
YANG implements a hierarchical model of what the device can do. Unlike SNMP this model is fetched from the device.

\subsection{NETCONF}
NETCONF is a protocol that is used to configure and monitor network devices. It uses the YANG data modeling language to describe the configuration and state of network devices.
NETCONF can be implemented over any protocol but is usually implemented over SSH \cite{ennsNetworkConfigurationProtocol2011}.

\subsection{I2C}
I2C is a two wire bus protocol used to communicate between devices. Each device has an address on the bus and can be read from and Written to.
Only one device can communicate on the bus at a time. The I2C bus is a master slave bus, the master controls the bus and the slaves respond to the master.
I2C stands for Inter-Integrated Circuit and was developed by Philips in 1982, now known as NXP \cite{I2CbusSpecificationUser2021}.

\section{Design}
\subsection{Philosophy}
We believe that simplicity is the key to robust systems, the Spark4pi-sensors platform is designed following this simple philosophy based on the 
Unix philosophy which favors modularity over monolithic design \cite{BasicsUnixPhilosophy}.
Each of Lightside Instruments AS products must therefor meet the following criteria:
\begin{itemize}
    \item Do one thing and do it well.
    \item Interopperate with other Lightside Instruments AS products.
    \item Present a NETCONF/YANG interface.
\end{itemize}
Consisting only of a power delivery system, an FPGA, twelve pull-up resistors and six RJ45 connectors. We have 
created a design that meets these criteria.
\\
\\
Through this simple philosophy Lightside Instruments AS has created an ecosystem of interoperating products that can be
leveraged in numerous ways.


\pagebreak
\addcontentsline{toc}{section}{References}
\printbibliography
\license
\end{document}